package com.evitalz.homevitalz.cardfit.ui.activities.connect_device

import android.graphics.Bitmap
import android.graphics.Canvas
import android.graphics.Color
import android.graphics.Paint
import android.os.Bundle
import android.util.Log
import android.view.View
import android.widget.ImageView
import android.widget.LinearLayout
import android.widget.TextView
import androidx.appcompat.app.AppCompatActivity
import androidx.lifecycle.lifecycleScope
import com.evitalz.homevitalz.cardfit.databinding.ActivityGraphBinding

import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch

class GraphActivity : AppCompatActivity() {

    lateinit var binding: ActivityGraphBinding
    val paint = Paint()
    val paint1 = Paint()
    val paint2 = Paint()
    val paint3 = Paint()
    lateinit var canv: Canvas
    lateinit var bitmap: Bitmap
    lateinit var drawingImageView: ZoomableImageView
    lateinit var textview: TextView
    var x_axis: ArrayList<Float> = ArrayList()
    var y_axis: ArrayList<Float> = ArrayList()
    lateinit var data :String


    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        binding = ActivityGraphBinding.inflate(layoutInflater)
        setContentView(binding.root)

//        drawingImageView = ZoomableImageView(this)
//
//        val layoutParams = LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, 300)
//        drawingImageView.layoutParams = layoutParams
//        drawingImageView.scaleType = ImageView.ScaleType.FIT_XY
//        textview = TextView(this@GraphActivity)
//
//        binding.linEcgActivity.addView(textview)
//        binding.linEcgActivity.addView(drawingImageView)


        bitmap = Bitmap.createBitmap(2345, 420, Bitmap.Config.ARGB_8888)
        canv = Canvas(bitmap)
        binding.zoomableimage.setImageBitmap(bitmap)

        paint.setColor(Color.rgb(0, 0, 0))
        paint.setStrokeWidth(2f)

        paint1.setColor(Color.rgb(207, 111, 110))
        paint1.setStrokeWidth(1f)

        paint2.setColor(Color.rgb(207, 111, 110))
        paint2.setStrokeWidth(3f)

        paint3.setColor(Color.rgb(207, 111, 110))
        paint3.setStrokeWidth(2f)
        draw()
    }

    fun draw() = lifecycleScope.launch(Dispatchers.Main) {

        when(intent.extras!!.get("type")){
            1 ->{
                data= intent.extras!!.getString("ECG_graphvalues").toString()
            }
            else ->{
                 data = "0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-41,63,-41,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-41,63,-41,63,-41,63,-41,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,61,64,82,64,102,64,123,64,123,64,123,64,102,64,82,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,61,64,82,64,82,64,102,64,102,64,82,64,82,64,61,64,61,64,41,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,41,64,61,64,82,64,102,64,102,64,82,64,61,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-41,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,61,64,61,64,61,64,82,64,82,64,61,64,61,64,61,64,61,64,61,64,61,64,41,64,41,64,20,64,0,64,0,64,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-41,63,-41,63,-20,63,-20,63,0,64,20,64,61,64,82,64,102,64,102,64,102,64,61,64,41,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-41,63,-41,63,-61,63,-61,63,-61,63,-61,63,-61,63,-61,63,-41,63,-41,63,-41,63,-61,63,-61,63,-61,63,-41,63,-41,63,-20,63,-20,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-61,63,-61,63,-41,63,-41,63,-41,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-41,63,-61,63,-82,63,-82,63,-82,63,-61,63,-61,63,-61,63,-41,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-41,63,-41,63,-41,63,-41,63,-20,63,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,20,64,20,64,20,64,20,64,41,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,61,64,102,64,123,64,-113,64,-113,64,123,64,102,64,61,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,61,64,61,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,20,64,41,64,61,64,82,64,102,64,102,64,102,64,82,64,61,64,41,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,41,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,20,64,41,64,61,64,82,64,102,64,102,64,82,64,61,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,61,64,61,64,82,64,82,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,0,64,0,64,0,64,0,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,20,64,41,64,61,64,82,64,102,64,102,64,102,64,102,64,82,64,61,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,61,64,82,64,82,64,82,64,82,64,61,64,61,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-41,63,-41,63,-20,63,-20,63,0,64,20,64,41,64,61,64,102,64,102,64,123,64,102,64,102,64,61,64,41,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-41,63,-41,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,41,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,102,64,82,64,82,64,82,64,61,64,41,64,41,64,41,64,41,64,41,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,61,64,82,64,102,64,102,64,82,64,61,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,61,64,61,64,82,64,82,64,102,64,102,64,102,64,102,64,102,64,82,64,82,64,61,64,61,64,41,64,41,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,61,64,82,64,102,64,82,64,61,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-41,63,-41,63,-41,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,41,64,41,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,61,64,61,64,61,64,61,64,61,64,61,64,41,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,41,64,61,64,102,64,123,64,123,64,102,64,82,64,61,64,41,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,41,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,102,64,102,64,102,64,102,64,102,64,102,64,82,64,61,64,61,64,61,64,41,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,41,64,61,64,102,64,123,64,123,64,102,64,82,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,61,64,61,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,0,64,0,64,41,64,61,64,102,64,123,64,-113,64,-113,64,123,64,82,64,61,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,61,64,82,64,102,64,102,64,102,64,102,64,102,64,82,64,61,64,41,64,41,64,41,64,41,64,41,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,20,64,41,64,61,64,102,64,123,64,-113,64,-113,64,-113,64,102,64,82,64,41,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,41,64,41,64,61,64,61,64,82,64,102,64,102,64,123,64,123,64,123,64,102,64,102,64,102,64,102,64,102,64,102,64,102,64,102,64,102,64,82,64,82,64,61,64,61,64,41,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,82,64,102,64,123,64,123,64,123,64,102,64,61,64,41,64,20,64,20,64,20,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,61,64,61,64,61,64,61,64,61,64,41,64,41,64,41,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,41,64,61,64,102,64,123,64,-113,64,-113,64,123,64,102,64,61,64,41,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,61,64,61,64,82,64,82,64,61,64,61,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,61,64,82,64,123,64,-113,64,-113,64,123,64,102,64,61,64,41,64,20,64,20,64,20,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,41,64,41,64,41,64,61,64,61,64,61,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,61,64,61,64,61,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,61,64,102,64,123,64,-113,64,-113,64,123,64,102,64,82,64,61,64,41,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,41,64,41,64,61,64,61,64,61,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,61,64,61,64,41,64,41,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,61,64,82,64,82,64,102,64,102,64,102,64,82,64,61,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,20,64,20,64,20,64,20,64,20,64,41,64,41,64,41,64,61,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,61,64,61,64,41,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,61,64,102,64,-113,64,-92,64,-92,64,-113,64,102,64,61,64,41,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,41,64,41,64,41,64,61,64,61,64,61,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,61,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-41,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,82,64,102,64,123,64,-113,64,-113,64,123,64,82,64,61,64,20,64,20,64,0,64,0,64,0,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,41,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,102,64,102,64,102,64,102,64,102,64,82,64,82,64,61,64,41,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,41,64,61,64,102,64,102,64,102,64,102,64,61,64,41,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,41,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,61,64,61,64,61,64,41,64,41,64,20,64,20,64,20,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-41,63,-41,63,-41,63,-41,63,-41,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-20,63,0,64,0,64,20,64,61,64,82,64,102,64,102,64,82,64,61,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-41,63,-41,63,-41,63,-61,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-41,63,-20,63,-20,63,-20,63,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,20,64,20,64,20,64,20,64,20,64,20,64,41,64,61,64,61,64,61,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,82,64,61,64,41,64,41,64,20,64,20,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,0,64,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63,-20,63"
                Log.d("ECGgraphLefthand", "draw: $data")
            }
        }
        val list: List<String> = data!!.split(",")
        val split = 2500 / 500
        var startx: Float
        var starty: Float
        var endx: Float
        var endy: Float
        val center = 280
        starty = center.toFloat()
        startx = 45f
        
            var i = 45
            while (i <= 2295) {
                publishProgress(i.toFloat().toString(), "45f", i.toFloat().toString(), "405f", "graph", i.toString())
                i += split
            }
        
        
             i = 45
            while (i <= 405) {
                publishProgress("45f", i.toFloat().toString(), "2295f", i.toFloat().toString(), "graph", i.toString())
                i += split
            }
        
        
             i = 0
            while (i + 1 < list.size) {
                var tx: Int = list.get(i).toInt()
                var ty = 0
                //                    String ty=array.get(i+1);
                if (tx < 0) {
                    tx += 256
                }
                ty = list.get(i + 1).toInt() * 256 + tx
                endx = ((startx + 0.9).toFloat())
                endy = Math.abs(center - (ty - 16000) / 7).toFloat()
                //                    endy = (((((ty -16000.0f)))));
                if (i == 0) starty = endy
                println("@@@$tx $ty")
                publishProgress(startx.toString(), starty.toString(), endx.toString(), endy.toString(), "line", "")
                startx = endx
                starty = endy
                x_axis.add(endx)
                y_axis.add(endy)
                i += 2
            }
//        drawingImageView.invalidate()
        binding.tvcase.text="Device Placement :" +intent.extras!!.getString("ECG_deviceplacement").toString()+ "       "+ "HeartRate :" + intent.extras!!.getString("ECG_value").toString()+" bpm" + "    "+ intent.extras!!.getString("ECG_case").toString()
        setChart()
    }

    private fun setChart(){
       binding.zoomableimage.setImageBitmap(this.bitmap)
    }

    private fun publishProgress(s1: String, s2: String, s3: String, s4: String, s5: String, s6: String){
        if (s5 == "graph") {
            if (s6.toInt() % 45 == 0) {
                this.canv.drawLine(s1.toFloat(), s2.toFloat(), s3.toFloat(), s4.toFloat(), paint3)
            } else {
                this.canv.drawLine(s1.toFloat(), s2.toFloat(), s3.toFloat(), s4.toFloat(), paint1)
            }
        } else {
            this.canv.drawLine(s1.toFloat(), s2.toFloat(), s3.toFloat(), s4.toFloat(), paint)
        }
//        this.canv = Canvas(this.bitmap)
//        this.drawingImageView.setImageBitmap(this.bitmap)
    }

}

